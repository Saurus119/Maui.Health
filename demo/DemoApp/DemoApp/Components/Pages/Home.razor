@page "/"

@if (_isAndroid)
{
    <div style="margin-bottom: 20px;">
        <h3>Live Workout Session</h3>
        @if (!_isWorkoutSessionActive)
        {
            <button @onclick="StartWorkoutSession" style="padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                Start Strength Training Session
            </button>
        }
        else
        {
            <button @onclick="EndWorkoutSession" style="padding: 10px 20px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                End Workout Session
            </button>
            <span style="color: #28a745; font-weight: bold;">● Session Active</span>
        }
        @if (!string.IsNullOrEmpty(_workoutSessionMessage))
        {
            <p style="color: @(_workoutSessionSuccess ? "green" : "red"); margin-top: 10px;">@_workoutSessionMessage</p>
        }
    </div>

    <div style="margin-bottom: 20px;">
        <h3>Quick Demo Data (Historical)</h3>
        <button @onclick="PopulateDemoData" style="padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Populate Demo Data
        </button>
        @if (!string.IsNullOrEmpty(_demoDataMessage))
        {
            <p style="color: @(_demoDataSuccess ? "green" : "red"); margin-top: 10px;">@_demoDataMessage</p>
        }
    </div>
}

@if (_isIOS)
{
    <div style="margin-bottom: 20px;">
        <h3>Live Workout Session</h3>
        @if (!_isWorkoutSessionActive)
        {
            <button @onclick="StartWorkoutSession" style="padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                Start Strength Training Session
            </button>
        }
        else
        {
            <button @onclick="EndWorkoutSession" style="padding: 10px 20px; background-color: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                End Workout Session
            </button>
            <span style="color: #28a745; font-weight: bold;">● Session Active</span>
        }
        @if (!string.IsNullOrEmpty(_workoutSessionMessage))
        {
            <p style="color: @(_workoutSessionSuccess ? "green" : "red"); margin-top: 10px;">@_workoutSessionMessage</p>
        }
    </div>

    <div style="margin-bottom: 20px;">
        <h3>Quick Demo Workout (Historical)</h3>
        <button @onclick="CreateIOSStrengthTraining" style="padding: 10px 20px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Create Past Strength Training
        </button>
        @if (!string.IsNullOrEmpty(_iosStrengthTrainingMessage))
        {
            <p style="color: @(_iosStrengthTrainingSuccess ? "green" : "red"); margin-top: 10px;">@_iosStrengthTrainingMessage</p>
        }
    </div>
}

@if (!_isAndroid && !_isIOS)
{
    <div style="margin-bottom: 20px;">
        <button disabled style="padding: 10px 20px; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: not-allowed;">
            Populate Demo Data
        </button>
        <p style="color: #6c757d; margin-top: 10px; font-style: italic;">Writing demo data is available only for Android and iOS.</p>
    </div>
}

<hr style="margin: 20px 0;" />

<h1>Number of steps:</h1>
@_steps

<h1>Weight (kg):</h1>
@_weight

<h1>Active Calories Burned (kcal):</h1>
@_calories

<h1>Average Heart Rate during Exercise (14:00-17:00):</h1>
@if (_heartRateCount > 0)
{
    <p>@_averageHeartRate.ToString("F1") BPM (based on @_heartRateCount measurements)</p>
}
else
{
    <p>No heart rate data available for this time period</p>
}

<hr style="margin: 20px 0;" />

<h1>Today's Workouts:</h1>
@if (_workouts.Length > 0)
{
    <ul>
        @foreach (var workout in _workouts)
        {
            var distanceKm = workout.Distance.HasValue ? (workout.Distance.Value / 1000.0).ToString("F2") : null;
            var calories = workout.EnergyBurned.HasValue ? workout.EnergyBurned.Value.ToString("F0") : null;
            var avgHR = workout.AverageHeartRate.HasValue ? workout.AverageHeartRate.Value.ToString("F0") : null;

            <li>
                <strong>@workout.ActivityType</strong> -
                @workout.StartTime.ToLocalTime().ToString("HH:mm") to @workout.EndTime.ToLocalTime().ToString("HH:mm")
                (@((int)workout.DurationSeconds / 60) minutes)
                @if (distanceKm != null)
                {
                    <span> - @distanceKm km</span>
                }
                @if (calories != null)
                {
                    <span> - @calories kcal</span>
                }
                @if (avgHR != null)
                {
                    <span> - Avg HR: @avgHR BPM</span>
                }

                <br/>
                <small>Source: @workout.DataOrigin</small>
            </li>
        }
    </ul>
}
else
{
    <p>No workouts found for today</p>
}
